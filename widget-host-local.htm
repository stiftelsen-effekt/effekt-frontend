<!-- 
TESTING BED

This is only a shell to host the widget in. Please do
not make changes to this file, only make changes to
widget.html, then run
gulp build
in your terminal. This takes the HTML from widget.html
and copies it into this file for local testing.

Open widget-host-local.htm in your browser to test
changes you've made in widget.html.

Widget-host-production.htm fetches the production code from
the server and hosts it in a testing bed with the same
structure as this file.
--><!DOCTYPE html><html><head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="dist/widget.css">
        <link rel="stylesheet" type="text/css" href="dist/widget-mobile.css">
        <link rel="stylesheet" type="text/css" href="dist/host.css">
        <meta name="viewport" content="width=device-width,initial-scale=1">

        <script src="script/lib/fastclick.js"></script>
    </head>
    <body>
        <div id="host-wrapper">
            <strong>API selection</strong><br>
            <div id="api-url-selector">
                <div class="label" id="selector-production">Production</div>
                <div class="label" id="selector-stage">Stage</div>
                <div class="label" id="selector-dev">Dev</div>
                <div class="label" id="selector-local">Local</div>
            </div>

            <div id="donation-btn">Doner n√• üíñ</div>
        </div>
        
        <div id="donation-widget-container">Ôªø<div id="donation-widget">
    <div class="close-btn"></div>

    <div class="inner">
        <div id="no_api_error">
            <h3>Ingen tilkobling</h3>
            <p>Hei! Vi n√•r dessverre ikke serveren v√•r fra din maskin. Du kan fors√∏ke igjen p√• et senere tidspunkt. Takk!</p>
        </div>

        <div class="slider" data-cy="slider">
            <div class="pane payment-method">
                <div class="inner">
                    <div class="selection active">
                        <h3>Betalingsm√•te</h3>

                        <span>Kostnadene angitt dekkes av oss, slik <br> at 100% av din donasjon kommer frem.</span>

                        <div class="payment-methods">
                            <div class="method bank" data-cy="method-bank">
                                <div class="transaction-costs">2kr</div>
                            </div>

                            <div class="method paypal" data-cy="method-paypal">
                                <div class="transaction-costs">1,90% + 2,8kr</div>
                            </div>

                            <div class="method vipps" data-cy="method-vipps">
                                <div class="transaction-costs">2,99%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pane basic">
                <div class="inner">
                    <h3>Om deg</h3>
                    <input type="text" class="name" data-cy="name" placeholder="Navn" autocomplete="off">
                    <input type="text" class="email" data-cy="email" placeholder="Email" autocomplete="off">
                    
                    <div class="checkbox-wrapper">
                        <input type="checkbox" name="tax-deduction" id="check-tax-deduction" data-cy="check-tax-deduction" autocomplete="off"> 
                        <label for="check-tax-deduction">Jeg √∏nsker skattefradrag 
                            <div id="hover-field"> 
                                <a target="_blank" id="info-icon"></a>
                                <span id="tooltip">Vi trenger ditt f√∏dselsnummer for √• rapportere skattefradrag til Skatteetaten for at du skal f√• skattefradrag for donasjonen din.</span>
                            </div>
                        </label>
                    </div>

                    <input type="text" class="ssn" data-cy="ssn" placeholder="F√∏dselsnr eller orgnr" autocomplete="off" style="display: none;">

                    <div class="checkbox-wrapper">
                        <input type="checkbox" name="privacy-policy" id="check-privacy-policy" data-cy="check-privacy-policy" autocomplete="off"> 
                        <label for="check-privacy-policy">Jeg godtar <a href="https://gieffektivt.no/samarbeid-drift#personvern" target="_blank">personvernerkl√¶ringen *</a></label>
                    </div>

                    <div class="checkbox-wrapper">
                        <input type="checkbox" name="newsletter" id="check-newsletter" autocomplete="off"> 
                        <label for="check-newsletter">Jeg √∏nsker √• melde meg p√• nyhetsbrevet</label>
                    </div>

                    <div class="anonymous-section">
                        <div class="underline"></div>
                        <span>ELLER</span>
                        <div class="underline"></div>
                    </div>
                    <div class="anonymous-link">Hopp over</div>
                    <!-- Spacer to make sure that the skip button is not too close to the prev / next buttons -->
                    <!-- Padding would make the button clickable to close to the other buttons -->
                    <div class="spacer"></div>
                </div>
            </div>

            <div class="pane amount">
                <div class="inner">
                    <h3>Om donasjonen</h3>
                    <div class="controls">
                        <div class="amount-wrapper">
                            <input data-cy="amount" type="text" class="amount" placeholder="sum" pattern="[0-9]*" inputmode="numeric" nocomma="true" autocomplete="off">
                            <span class="currency">kr</span>
                        </div>

                        <div class="recurring">
                            <div class="select recurring">
                                <label for="check-select-recurring">Jeg vil gi en m√•nedlig donasjon</label>
                                <input type="radio" name="recurring-selection" id="check-select-recurring" data-cy="check-select-recurring-input" checked="true" autocomplete="off">
                                <label class="box" for="check-select-recurring" data-cy="check-select-recurring"></label>
                            </div>
                            <div class="select recurring">
                                <label for="check-select-single">Jeg vil gi en engangsdonajson</label>
                                <input type="radio" name="recurring-selection" id="check-select-single" data-cy="check-select-single-input" autocomplete="off">
                                <label class="box" for="check-select-single" data-cy="check-select-single"></label>
                            </div>
                        </div>

                        <div class="split">
                            <div class="select split">
                                <label for="check-select-recommended">Bruk v√•r anbefalte fordeling</label>
                                <input type="radio" name="split-selection" id="check-select-recommended" data-cy="check-select-recommended-input" checked="true" autocomplete="off">
                                <label class="box" for="check-select-recommended" data-cy="check-select-recommended"></label>
                            </div>
                            <div class="select split">
                                <label for="check-select-split">Jeg vil velge fordeling selv</label>

                                <input type="radio" name="split-selection" id="check-select-split" data-cy="check-select-split-input" autocomplete="off">
                                <label class="box" for="check-select-split" data-cy="check-select-split"></label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pane shares hidden scrollable">
                <div class="inner">
                    <h3>Velg fordeling</h3>
                    <div class="share-distribution">
                        <ul class="organizations">
                        </ul>

                        <ul class="overlay-organizations"></ul>

                        <span class="total" data-cy="total">0/100</span>
                    </div>
                </div>
            </div>

            <div class="pane referral">
                <div class="inner">
                    <h3>Hvor h√∏rte du om oss?</h3>
                    <span class="subtitle">Valgfritt</span>

                    <ul id="referral-list"></ul>
                    <div id="other-referral-freetext" class="other-referral-freetext hidden">
                        <label for="other-referral-input">Fortell gjerne hvordan du h√∏rte om oss:</label>
                        <textarea id="other-referral-input" name="other-referral" maxlength="1000"></textarea>
                    </div>
                </div>
            </div>

            <div class="pane paypal">
                <div class="inner">
                    <h3>G√• til paypal</h3>
                    <button id="widget-paypal-button">Doner n√•</button>
                </div>
                <form action="https://www.paypal.com/cgi-bin/webscr" method="post" id="payPalSingleForm" target="_blank" style="display: inline-block;">
                    <input type="hidden" name="cmd" value="_donations">
                    <input type="hidden" name="charset" value="UTF-8">
                    <input type="hidden" name="currency_code" value="NOK">
                    <input type="hidden" name="amount" value="500">
                    <input type="hidden" name="business" value="donasjon@gieffektivt.no">
                    <input type="hidden" name="item_name" value="Donasjon">
                    <input type="hidden" name="notify_url" value="https://api.gieffektivt.no/paypal/ipn">
                    <input type="hidden" name="custom" value="blank">

                    <input type="submit" style="display: none;" id="submitSinglePaypal">
                </form>

                <form action="https://www.paypal.com/cgi-bin/webscr" method="post" id="payPalRecurringForm" target="_blank" style="display: inline-block;">
                    <input type="hidden" name="cmd" value="_xclick-subscriptions">
                    <input type="hidden" name="charset" value="UTF-8">
                    <input type="hidden" name="currency_code" value="NOK">
                    <input type="hidden" name="business" value="donasjon@gieffektivt.no">
                    <input type="hidden" name="item_name" value="M√•nedlig donasjon til Stiftelsen Effekt">
                    <input type="hidden" name="notify_url" value="https://api.gieffektivt.no/paypal/ipn">
                    <input type="hidden" name="custom" value="blank">
                    <input type="hidden" name="a3" value="500">
                    <input type="hidden" name="p3" value="1">
                    <input type="hidden" name="t3" value="M">
                    <input type="hidden" name="src" value="1">
                    <input type="hidden" name="srt" value="24">
                    <input type="hidden" name="no_note" value="1">
                    
                    <input type="submit" style="display: none;" id="submitRecurringPaypal">
                </form>

                <div class="awaiting-confirmation">
                    <img src="https://storage.googleapis.com/effekt-widget/assets/loading.svg">
                    <strong>Venter p√• bekreftelse p√• innbetaling fra paypal</strong>
                </div>
            </div>

            <div class="pane vipps">
                <div class="inner">
                    <img src="https://storage.googleapis.com/effekt-widget/assets/logos/vipps.png" class="header">
                    
                    <div class="vipps-btn-wrapper">
                        <a href="#" id="vipps-link">
                            <div class="vipps-btn" data-cy="vipps-btn"></div>
                        </a>
                    </div>
                </div>
            </div>

            <div class="pane result">
                <div class="inner">
                    <h3>Takk!</h3>

                    <img src="https://storage.googleapis.com/effekt-widget/assets/heart.svg" class="heart">

                    <div class="result-type bank-pending">
                        <h4>Du kan n√• overf√∏re til oss.</h4>
                            
                        <div class="transfer-info">
                            <div class="line">
                                <label>Kontonr</label><span class="account select-on-click" x-ms-format-detection="none">1506 29 95960</span>
                            </div>
                            <div class="line">
                                <label>KID</label><span class="KID select-on-click" x-ms-format-detection="none" id="bank-kid"></span>
                            </div>
                        </div>
                        <span class="email-text">Vi har ogs√• sendt en mail til <font class="email"></font> med informasjon om din donasjon. Sjekk s√∏ppelpost-mappen om du ikke har mottatt eposten i l√∏pet av noen timer.</span>
                    </div>

                    <div class="result-type vipps-pending">
                        <p>Vi bruker vanligvis noen dager p√• √• bekrefte Vipps-donasjoner. Du vil f√• en mail til <font class="email"></font> n√•r vi har bekreftet din donasjon. Sjekk s√∏ppelpost-mappen om du ikke har mottatt eposten i l√∏pet av noen dager.</p>
                    </div>

                    <div class="result-type donation-confirmed">
                        <p>Vi har n√• mottatt din donasjon! Vi har ogs√• sendt en kvittering til <font class="email"></font> med mer informasjon. Sjekk s√∏ppelpost-mappen om du ikke har mottatt eposten i l√∏pet av noen timer.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="error"></div>
        <div class="progress" style="width: 0%;"></div>
    </div>
</div>
</div>

<script src="dist/bundle.js"></script>
<script>
var localUrl = "http://localhost:3000/"
const prodUrl = "https://data.gieffektivt.no/"
const stageUrl = "https://stage.data.gieffektivt.no/"
const devUrl = "https://dev.data.gieffektivt.no/"

var donationWidgetElement = document.getElementById("donation-widget");
var widget = new DonationWidget();

widget.setup(widget, donationWidgetElement);
document.getElementById("donation-btn").addEventListener("click", function(e) {
    widget.show();
});

const prodSelector = document.getElementById("selector-production")
const stageSelector = document.getElementById("selector-stage")
const devSelector = document.getElementById("selector-dev")
const localSelector = document.getElementById("selector-local")

if (widget.network.api_url === prodUrl)
    prodSelector.classList.add("active")
else if (widget.network.api_url === stageUrl)
    stageSelector.classList.add("active")
else if (widget.network.api_url === devUrl)
    devSelector.classList.add("active")
else if (widget.network.api_url.indexOf("localhost") !== -1) {
    localUrl = widget.network.api_url
    localSelector.classList.add("active")
}
else
    alert("Could not determine API url from widget.network.api_url")

localSelector.addEventListener("click", () => {
    clearSelection()
    localSelector.classList.add("active")
    widget.network.api_url = localUrl
})

prodSelector.addEventListener("click", () => {
    clearSelection()
    prodSelector.classList.add("active")
    widget.network.api_url = prodUrl
})

stageSelector.addEventListener("click", () => {
    clearSelection()
    stageSelector.classList.add("active")
    widget.network.api_url = stageUrl
})

devSelector.addEventListener("click", () => {
    clearSelection()
    devSelector.classList.add("active")
    widget.network.api_url = devUrl
})

function clearSelection() {
    localSelector.classList.remove("active")
    prodSelector.classList.remove("active")
    stageSelector.classList.remove("active")
    devSelector.classList.remove("active")
}
</script>

</body></html>